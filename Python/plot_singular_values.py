# -*- coding: utf-8 -*-
"""
Created on Fri Mar 25 13:08:45 2022

@author: USER
"""
import matplotlib.pyplot as plt
import numpy as np

data_folder = "../../lid_driven_data/"
t2= [3.51052982e+07, 2.14351119e+07, 1.10442289e+07, 6.39422012e+06,
 5.56480094e+06, 3.68922687e+06, 2.98608553e+06, 2.50908370e+06,
 1.49792513e+06, 1.02902136e+06, 8.91385826e+05, 5.91419524e+05,
 4.98585035e+05, 4.64998752e+05, 4.36238626e+05, 3.06695838e+05,
 2.77004090e+05, 2.69679648e+05, 2.02088203e+05, 1.78592604e+05,
 1.64802005e+05, 1.41122744e+05, 1.27477969e+05, 1.16701394e+05,
 1.11645697e+05, 9.13009720e+04, 8.26208747e+04, 7.66049790e+04,
 7.16481606e+04, 6.62139825e+04, 6.15282643e+04, 5.29864031e+04,
 4.79145197e+04, 4.51383605e+04, 3.92991687e+04, 4.17804383e+03,
 2.80787008e+03, 2.44400413e+02]

t1= [3.13976547e+06, 5.27005233e+05, 2.04658627e+05, 1.60626305e+05,
 1.24441931e+05, 8.14891345e+04, 5.07974379e+04, 4.10270411e+04,
 3.83071429e+04, 3.43186655e+04, 3.13016741e+04, 2.95985273e+04,
 2.70846310e+04, 2.56364815e+04, 2.36687873e+04, 2.20907250e+04,
 2.12370527e+04, 1.84924883e+04, 1.77932992e+04, 1.71357118e+04,
 1.65782903e+04, 1.63657259e+04, 1.55547057e+04, 1.46560374e+04,
 1.35627890e+04, 1.31920814e+04, 1.19208312e+04, 1.15763788e+04,
 1.14202438e+04, 1.04810490e+04, 9.15385633e+03, 8.82651277e+03,
 8.47885358e+03, 7.53230900e+03, 6.77410893e+03, 2.00265903e+00,
 1.05890852e+00, 4.57548584e-02]
# t2 = [3.20430942e+09, 2.05824645e+09, 8.11301743e+08, 6.85625554e+08,
#  3.56300706e+08, 3.02106163e+08, 2.57782639e+08, 2.17594956e+08,
#  1.49316001e+08, 1.12667699e+08, 8.31690116e+07, 6.97243601e+07,
#  6.02370412e+07, 4.82307480e+07, 4.25004352e+07, 3.82552406e+07,
#  2.67672646e+07, 2.41373090e+07, 2.13416827e+07, 2.04504737e+07,
#  1.74182178e+07, 1.46614265e+07, 1.27808350e+07, 1.13506772e+07,
#  1.08212332e+07, 9.42917166e+06, 8.03341730e+06, 7.22673610e+06,
#  6.77731136e+06, 6.61703940e+06, 5.91317419e+06, 5.19014568e+06,
#  4.62021167e+06, 3.70125657e+06, 2.90043976e+06, 4.48731893e+05,
#  6.03784173e+04, 3.03370764e+04]
# t1 = [2.33876186e+08, 5.77424247e+07, 2.19375741e+07, 1.66596143e+07,
#  1.05289654e+07, 6.16149843e+06, 5.32824015e+06, 4.23473994e+06,
#  3.76793554e+06, 3.66616002e+06, 3.49981268e+06, 3.02359709e+06,
#  2.89549783e+06, 2.59649861e+06, 2.52158364e+06, 2.38885803e+06,
#  2.10099554e+06, 1.98563639e+06, 1.89302202e+06, 1.86003447e+06,
#  1.70049546e+06, 1.55023086e+06, 1.50559194e+06, 1.49658672e+06,
#  1.39232236e+06, 1.32471458e+06, 1.26422431e+06, 1.15693364e+06,
#  1.06734448e+06, 1.02429524e+06, 9.11529584e+05, 8.89082688e+05,
#  7.47299319e+05, 7.03643340e+05, 6.44862496e+05, 8.85877042e+01,
#  5.66942180e+00, 5.01468664e+00]
fig = plt.figure()
plt.semilogy(t1, label = 't=150')
plt.semilogy(t2, label = 't=300')
plt.ylabel("Singular Value Magnitude")
plt.xlabel("Singular Value Number")
plt.title("Singular Values of Sensitivity Matrix for Velocity of Cavity")
plt.legend()
fig.tight_layout()

plt.savefig(data_folder + "sensitivity/singular values.png")